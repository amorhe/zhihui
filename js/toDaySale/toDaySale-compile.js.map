{"version":3,"sources":["toDaySale.js"],"names":[],"mappings":";;;;;;AAAA,IAAI,MAAM,IAAI,GAAJ,CAAQ;AACd,QAAI,MADU;AAEd,UAAM;AACF,oBAAW,UADT;AAEF,kBAAU,EAFR;AAGF,4BAAoB,EAHlB;AAIF,cAAM,CAJJ;AAKF,mBAAW,IALT;AAMF,iBAAS,KANP,EAMa;AACf,sBAAc,IAPZ,CAOiB;AAPjB,KAFQ;AAWd,WAXc,qBAWJ;AAAA;;AACN;AACA,YAAI,CAAC,aAAa,kBAAlB,EAAsC;AAClC,qBAAS,MAAT,CAAgB,cAAhB;AACH;;AAED,YAAI,qBAAqB,KAAK,cAAL,CAAoB,oBAApB,CAAzB;AACA,aAAK,kBAAL,GAA0B,kBAA1B;AACA,mBAAW,YAAM;AACb,kBAAK,YAAL,CAAkB,kBAAlB,EAAsC,MAAK,IAA3C;AACH,SAFD;AAGH,KAtBa;;AAuBd,aAAS;AACL,YADK,gBACA,GADA,EACK,EADL,EACS,kBADT,EAC6B,MAD7B,EACqC;AACtC,qBAAS,MAAT,CAAmB,GAAnB,YAA6B,EAA7B,4BAAsD,kBAAtD,gBAAmF,MAAnF;AACH,SAHI;AAIL,YAJK,kBAIE;AACH,oBAAQ,EAAR,CAAW,CAAC,CAAZ;AACH,SANI;AAOL,sBAPK,0BAOU,IAPV,EAOgB;AACjB,gBAAI,MAAM,IAAI,MAAJ,CAAW,UAAU,IAAV,GAAiB,eAA5B,CAAV;AACA,gBAAI,IAAI,OAAO,QAAP,CAAgB,MAAhB,CAAuB,MAAvB,CAA8B,CAA9B,EAAiC,KAAjC,CAAuC,GAAvC,CAAR;AACA,gBAAI,KAAK,IAAT,EAAe,OAAO,SAAS,EAAE,CAAF,CAAT,CAAP;AACf,mBAAO,IAAP;AACH,SAZI;AAaC,oBAbD;AAAA,gGAac,kBAbd,EAakC,IAblC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAckB,kBAAkB,kBAAlB,EAAsC,IAAtC,CAdlB;;AAAA;AAcG,sCAdH;;AAeD,oCAAI,OAAO,IAAP,KAAgB,CAApB,EAAuB;AACnB,0CAAM,OAAO,OAAb;AACH;AACD,oCAAI,OAAO,IAAP,KAAgB,CAApB,EAAuB;AACnB,4CAAQ,GAAR,CAAY,OAAO,IAAnB;AACI,uCAFe,GAET,EAFS;;AAGnB,yCAAS,CAAT,IAAc,OAAO,IAArB,EAA2B;AACvB,4CAAI,IAAJ,CAAS,OAAO,IAAP,CAAY,CAAZ,CAAT;AACH;AACD,yCAAK,QAAL,GAAgB,GAAhB;AACA,4CAAQ,GAAR,CAAY,GAAZ;AACA,wCAAI,KAAK,QAAL,CAAc,MAAd,KAAyB,OAAO,IAAP,CAAY,KAAZ,GAAoB,CAAjD,EAAoD;AAChD,6CAAK,SAAL,GAAiB,KAAjB;AACH;AACJ;;AA7BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA+BC,mBA/BD;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAgCG,KAAK,SAAL,KAAmB,KAhCtB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,sCAmCG,EAAE,MAAF,EAAU,SAAV,KAAwB,EAAE,MAAF,EAAU,MAAV,EAAxB,GAA6C,EAA7C,IAAmD,EAAE,QAAF,EAAY,MAAZ,EAnCtD;AAAA;AAAA;AAAA;;AAoCG,qCAAK,SAAL,GAAiB,KAAjB;AACA,qCAAK,OAAL,GAAe,IAAf;AACA,qCAAK,IAAL;AACI,sCAvCP;;AAAA,qCAwCO,KAAK,YAxCZ;AAAA;AAAA;AAAA;;AAyCO,qCAAK,YAAL,GAAoB,KAApB,CAzCP,CAyCiC;AAzCjC;AAAA,uCA0CsB,kBAAkB,KAAK,kBAAvB,EAA2C,KAAK,IAAhD,CA1CtB;;AAAA;AA0CO,sCA1CP;;AAAA,sCA2CW,OAAO,IAAP,KAAgB,CA3C3B;AAAA;AAAA;AAAA;;AA2C+B;AACpB,qCAAK,OAAL,GAAe,KAAf;AACA;;AA7CX,sCA8Ce,KAAK,QAAL,CAAc,MAAd,KAAyB,OAAO,IAAP,CAAY,KAAZ,GAAoB,CA9C5D;AAAA;AAAA;AAAA;;AA+Ce,wCAAQ,GAAR,CAAY,QAAZ;AA/Cf;;AAAA;AAkDe,qCAAK,YAAL,GAAoB,IAApB;AACI,mCAnDnB,GAmDyB,EAnDzB;;AAoDe,qCAAS,CAAT,IAAc,OAAO,IAArB,EAA2B;AACvB,wCAAI,IAAJ,CAAS,OAAO,IAAP,CAAY,CAAZ,CAAT;AACH;AACD,qCAAK,QAAL,GAAgB,GAAhB;AACA,qCAAK,QAAL,gCAAoB,KAAK,QAAzB,GAAsC,GAAtC;;AAxDf;AAAA;AAAA;;AAAA;AA2DW,2CAAW,YAAM;AACb,2CAAK,OAAL,GAAe,KAAf;AACA,2CAAK,YAAL,GAAoB,IAApB;AACH,iCAHD,EAGG,IAHH;;AA3DX;AAAA;AAAA;;AAAA;AAiEO,qCAAK,OAAL,GAAe,KAAf;;AAjEP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAvBK,CAAR,CAAV","file":"toDaySale-compile.js","sourcesContent":["let app = new Vue({\r\n    el: \"#app\",\r\n    data: {\r\n        baseImgUrl:ImgBaseUrl,\r\n        shopList: [],\r\n        longitude_latitude: '',\r\n        page: 1,\r\n        allLoaded: true,\r\n        loading: false,//判断是否加载数据\r\n        loading_more: true,//控制是否发送ajax请求\r\n    },\r\n    mounted() {\r\n        //路由拦截。。。\r\n        if (!localStorage.longitude_latitude) {\r\n            location.assign('./index.html')\r\n        }\r\n\r\n        let longitude_latitude = this.GetQueryString('longitude_latitude')\r\n        this.longitude_latitude = longitude_latitude\r\n        setTimeout(() => {\r\n            this.getStoreList(longitude_latitude, this.page)\r\n        })\r\n    },\r\n    methods: {\r\n        goTo(url, id, longitude_latitude, status) {\r\n            location.assign(`${url}?id=${id}&longitude_latitude=${longitude_latitude}&status=${status}`)\r\n        },\r\n        back() {\r\n            history.go(-1)\r\n        },\r\n        GetQueryString(name) {\r\n            let reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\r\n            let r = window.location.search.substr(1).match(reg);\r\n            if (r != null) return unescape(r[2]);\r\n            return null;\r\n        },\r\n        async getStoreList(longitude_latitude, page) {\r\n            let result = await todayDiscountList(longitude_latitude, page)\r\n            if (result.code === 0) {\r\n                alert(result.message)\r\n            }\r\n            if (result.code === 1) {\r\n                console.log(result.data)\r\n                let arr = []\r\n                for (let i in result.data) {\r\n                    arr.push(result.data[i])\r\n                }\r\n                this.shopList = arr\r\n                console.log(arr);\r\n                if (this.shopList.length === result.data.total + 1) {\r\n                    this.allLoaded = false\r\n                }\r\n            }\r\n        },\r\n        async loadingMore() {\r\n            if (this.allLoaded === false) {\r\n                return\r\n            }\r\n            if ($(window).scrollTop() + $(window).height() + 10 >= $(document).height()) {\r\n                this.allLoaded = false\r\n                this.loading = true;\r\n                this.page++;\r\n                let result\r\n                if (this.loading_more) {\r\n                    this.loading_more = false //禁止浏览器发送ajax请求\r\n                    result = await todayDiscountList(this.longitude_latitude, this.page)\r\n                    if (result.code === 1) {//判断接受是否成功\r\n                        this.loading = false\r\n                        // console.log(this.allSortList.length, result.data.total)\r\n                        if (this.shopList.length === result.data.total + 1) {\r\n                            console.log('没有更多数据')\r\n                            return\r\n                        } else {\r\n                            this.loading_more = true\r\n                            let arr = []\r\n                            for (let i in result.data) {\r\n                                arr.push(result.data[i])\r\n                            }\r\n                            this.shopList = arr\r\n                            this.shopList = [...this.shopList, ...arr];\r\n                        }\r\n                    } else {\r\n                        setTimeout(() => {\r\n                            this.loading = false\r\n                            this.loading_more = true\r\n                        }, 1000)\r\n                    }\r\n                } else {\r\n                    this.loading = false\r\n                }\r\n            }\r\n        },\r\n    }\r\n})\r\n"]}